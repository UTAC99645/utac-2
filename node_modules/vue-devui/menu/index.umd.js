(function(S,n){typeof exports=="object"&&typeof module!="undefined"?n(exports,require("vue"),require("clipboard")):typeof define=="function"&&define.amd?define(["exports","vue","clipboard"],n):(S=typeof globalThis!="undefined"?globalThis:S||self,n(S.index={},S.Vue))})(this,function(S,n){"use strict";function O(e,l,t){let s=e;return l&&(s+=`__${l}`),t&&(s+=`--${t}`),s}function C(e,l=!1){const t=l?`.devui-${e}`:`devui-${e}`;return{b:()=>O(t),e:f=>f?O(t,f):"",m:f=>f?O(t,"",f):"",em:(f,m)=>f&&m?O(t,f,m):""}}const J=[];let W=[];const q=n.ref(24),x=C("menu"),ce=C("submenu"),_=x.b(),Q=`${x.b()}-item-horizontal-wrapper`,X=`${x.b()}-item-select`,Y=`${x.b()}-active-parent`;function de(e){q.value=e}function ue(e){J.push(e)}function fe(){W=[],J.forEach(t=>{W.push(t.el.parentElement)});const e=[...W],l=t=>{var s;return(s=/layer_(\d*)/gim.exec(t))==null?void 0:s[1]};for(;e.length;){const t=e.shift();if(t!=null&&t.classList.contains(_)){const s=t.children;e.unshift(...Array.from(s));continue}else{if(t.tagName==="DIV")if(t.classList.contains(`${x.b()}-item-vertical-wrapper`)||t.classList.contains(`${ce.b()}-menu-item-vertical-wrapper`)){const s=t.parentElement;if(e.unshift(...Array.from(t.children)),s!=null&&s.classList.contains(_))t.classList.add("layer_1");else{let a=l((s==null?void 0:s.classList.value)||"");a=Number(a),t.classList.add(`layer_${a}`)}}else{const s=t.parentElement;let a=l((s==null?void 0:s.classList.value)||"");a=Number(a),t.classList.add(`layer_${a}`),t.style.paddingLeft=`${(a===2?1:a-1)*q.value}px`}if(t.tagName==="UL"){const s=t.parentElement,a=t.children;for(let f=0;f<a.length;f++)e.unshift(a[f]);const o=(s==null?void 0:s.classList.value)||"";let d=l(o);s!=null&&s.classList.contains(_)?(d=1,t.classList.add(`layer_${2}`)):(t.classList.add(`layer_${Number(d)+1}`),d=Number(d)+1)}if(t.tagName==="LI"){const s=t.parentElement,a=(s==null?void 0:s.classList.value)||"";let o=l(a);l(a),o=Number(o),t.style.padding=`0 ${o*q.value}px`}}}}function me(e){var s;const l=e;let t=null;for(let a=0;a<l.length;a++){const o=l[a];(s=o==null?void 0:o.classList)!=null&&s.contains(`${x.b()}-horizontal`)&&(t=o)}return t}function pe(e,l){let t=l.target,s=[];const a=me(l.composedPath());for(s=[...Array.from(a.children)],t.tagName==="SPAN"&&(t=t.parentElement);s.length;){const o=s.shift();if((o==null?void 0:o.tagName)==="UL"||(o==null?void 0:o.classList.contains(Q))){const d=o==null?void 0:o.children;s.unshift(...Array.from(d))}o!==t&&(o==null||o.classList.remove(X),o==null||o.classList.remove(Y))}}function he(e,l){const t=[],s=l.path||l.composedPath&&l.composedPath();for(let a=0;a<s.length;a++){const o=s[a];if(!o.classList.contains(_))t.push(...Array.from(o.children));else{t.push(...Array.from(o.children));break}}for(;t.length;){const a=t.shift();((a==null?void 0:a.tagName)==="UL"||(a==null?void 0:a.classList.contains(Q)))&&t.push(...Array.from(a==null?void 0:a.children)),a!==e&&((a==null?void 0:a.tagName)==="DIV"&&t.unshift(...Array.from(a==null?void 0:a.children)),a==null||a.classList.remove(X),a==null||a.classList.remove(Y))}}function ee(e,l,t=!1){t?pe(e,l):he(e,l)}function ge(e){var s;const l=/layer_(\d{1,})/gim,t=e.className;return(s=l.exec(t))==null?void 0:s[1]}const ye={disabled:{type:Boolean,default:!1},href:{type:String,default:""},route:{type:[String,Object]}},te=C("menu");function ne(e,l,t,s){const a=n.ref(!1);return t?e.includes(l)?a.value=!0:a.value=!1:e[0]===l&&!s.value?a.value=!0:a.value=!1,a.value}function be(e){var t,s;let l=e.parentElement;for(;!l.classList.contains(te.b());)((t=l.firstElementChild)==null?void 0:t.tagName)==="DIV"&&((s=l==null?void 0:l.firstElementChild)==null||s.classList.add(`${te.b()}-active-parent`)),l=l.parentElement;return l}function ve(e,l,t,s){if(t&&l){const a=e.route||s,o=l.push(a).then(d=>d);return{route:a,routerResult:o}}}const F=C("menu");function se(e){const l=e.composedPath();for(let t=0;t<l.length;t++){const s=l[t];if(s.classList.contains(`${F.b()}-horizontal`))break;if(s.classList.contains(`${F.b()}-item-horizontal-wrapper`))continue;s.tagName!=="SPAN"&&s.classList.add(`${F.b()}-item-select`)}}const z=C("menu"),B=`${z.b()}-item-select`,we=`${z.b()}-item-disabled`;var Z=n.defineComponent({name:"DMenuItem",props:ye,setup(e,l){var c,y;const t=n.getCurrentInstance(),s=String(t==null?void 0:t.vnode.key),a=n.inject("menuStore"),o=n.inject("mode"),d=n.inject("multiple"),f=n.inject("defaultIndent"),m=n.inject("isCollapsed"),b=n.inject("defaultSelectKey"),{disabled:V}=n.toRefs(e),v=n.ref(ne(b.value,s,d,V)),$=n.ref(!0),M=n.inject("rootMenuEmit"),k=n.inject("useRouter"),A=t==null?void 0:t.appContext.config.globalProperties.$router,w=n.computed(()=>({[`${z.b()}-item`]:!0,[`${z.b()}-item-isCollapsed`]:m.value,[B]:v.value,[we]:V.value}));a.on("menuItem:clear:select",()=>{v.value=!1});const L=r=>{var u;r.stopPropagation();const i=r.currentTarget;let p;if(e.disabled&&r.preventDefault(),!e.disabled){if(!d)a.emit("menuItem:clear:select"),ee(i,r,o.value==="horizontal"),o.value==="horizontal"&&se(r),v.value=!0,p=ve(e,A,k.value,s);else if(i.classList.contains(B)){M("deselect",{type:"deselect",key:s,el:i,e:r}),v.value=!1;return}else v.value=!0,i.classList.add(B);p===void 0?M("select",{type:"select",key:s,el:i,e:r}):M("select",{type:"select",key:s,el:i,e:r,route:p})}if(o.value==="vertical"){const h=r.currentTarget;be(h)}if(o.value==="horizontal"){const h=(u=i.parentElement)==null?void 0:u.parentElement;h==null||h.classList.add(`${z.b()}-active-parent`)}},N=n.createVNode("span",{class:`${z.b()}-icon`},[(y=(c=l.slots).icon)==null?void 0:y.call(c)]),g=n.ref(null);return n.watch(V,()=>{d||(w.value[B]=!1)}),n.watch(()=>[...b.value],r=>{v.value=ne(r,s,d,V),w.value[B]=v.value}),n.onMounted(()=>{var p,u;let r="";const i=g.value;o.value==="vertical"&&((u=(p=i.parentElement)==null?void 0:p.parentElement)!=null&&u.classList.contains(z.b())?($.value=!0,$.value&&(i.style.paddingRight="",i.style.paddingLeft=`${f}px`),n.watch(m,h=>{h?(i.style.padding!=="0"&&(r=i.style.padding),setTimeout(()=>{i.style.padding="0",i.style.width="",i.style.textAlign="center"},300),i.style.display="block"):(i.style.padding=`${r}`,i.style.textAlign="",i.style.display="flex")})):$.value=!1)}),()=>o.value==="vertical"?n.createVNode("div",{class:`${z.b()}-item-vertical-wrapper`},[n.createVNode("li",{class:w.value,onClick:L,ref:g},[l.slots.icon!==void 0&&N,e.href===""?n.createVNode(n.Transition,{name:"fade"},{default:()=>{var r,i;return[n.withDirectives(n.createVNode("span",null,[(i=(r=l.slots).default)==null?void 0:i.call(r)]),[[n.vShow,!m.value]])]}}):n.createVNode("a",{href:e.href},[n.createVNode(n.Transition,{name:"fade"},{default:()=>{var r,i;return[(i=(r=l.slots).default)==null?void 0:i.call(r)]}})])])]):n.createVNode("li",{class:w.value,onClick:L,ref:g},[l.slots.icon!==void 0&&N,e.href===""?n.createVNode(n.Transition,{name:"fade"},{default:()=>{var r,i;return[n.withDirectives(n.createVNode("span",null,[(i=(r=l.slots).default)==null?void 0:i.call(r)]),[[n.vShow,!m.value]])]}}):n.createVNode("a",{href:e.href},[n.createVNode(n.Transition,{name:"fade"},{default:()=>{var r,i;return[(i=(r=l.slots).default)==null?void 0:i.call(r)]}})])])}});function ae(e=8){const l="abcdefghijklmnopqrstuvwxyz0123456789";let t="";for(let s=0;s<e;s++)t+=l[parseInt((Math.random()*l.length).toString())];return t}function le(e){for(;e&&e.tagName!=="LI"&&e.tagName!=="UL";)e=e.parentElement;return e}const oe="0.3s height ease-in-out, 0.3s padding-top ease-in-out, 0.3s padding-bottom ease-in-out",D={"before-enter"(e){e.style.transition=oe,e.setAttribute("data-oldPadding",e.style.padding),e.setAttribute("data-oldMargin",e.style.margin),e.style.height="0",e.style.padding="0",e.style.margin="0"},enter(e){e.dataset.oldOverflow=e.style.overflow,e.scrollHeight!==0?e.style.height=e.scrollHeight+"px":e.style.height="",e.style.padding=e.getAttribute("data-oldPadding"),e.style.margin=e.getAttribute("data-oldMargin"),e.style.overflow="hidden"},"after-enter"(e){e.style.transition="",e.style.transition="",e.style.height="",e.style.overflow=e.getAttribute("data-overflow")},"before-leave"(e){e.dataset||(e.dataset={}),e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.dataset.oldOverflow=e.style.overflow,e.style.height=e.scrollHeight+"px",e.style.overflow="hidden"},leave(e){e.scrollHeight!==0&&(e.style.transition=oe,e.style.height="0",e.style.paddingTop="0",e.style.paddingBottom="0")},"after-leave"(e){e.style.transition="",e.style.height="",e.style.overflow=e.dataset.oldOverflow,e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom}};var Le=n.defineComponent({name:"DMenuTransition",setup(e,l){return()=>n.createVNode(n.Transition,{onBeforeEnter:t=>D["before-enter"](t),onBeforeLeave:t=>D["before-leave"](t),onEnter:t=>D.enter(t),onAfterEnter:t=>D["after-enter"](t),onLeave:t=>D.leave(t),onAfterLeave:t=>D["after-leave"](t)},{default:()=>{var t,s;return[(s=(t=l.slots).default)==null?void 0:s.call(t)]}})}});const Ne={title:{type:String,default:""},disabled:{type:Boolean,default:!1}},R=C("menu"),$e=C("submenu"),I=`${R.b()}-item-horizontal-wrapper-hidden`,H=`${R.b()}-item-horizontal-wrapper-show`;function T(e,l,t){const s=l.currentTarget,a=s.parentElement,o=t.children;if(t.style.padding="0 20px !important",e==="mouseenter"){if((a==null?void 0:a.tagName)==="DIV"){t.classList.add(`${R.b()}-item-horizontal-wrapper-level`);const{width:d}=s.getClientRects()[0];t.style.top="0px",t.style.left=`${d}px`}else t.style.top="26px",t.style.left="0px";t.classList.remove(I),t.classList.add(H);for(let d=0;d<o.length;d++){const f=o[d];if(f.tagName==="UL"&&f.classList.contains($e.b())){const m=f.getElementsByClassName(`${R.b()}-item-horizontal-wrapper`)[0];f.addEventListener("mouseenter",b=>{b.stopPropagation(),T("mouseenter",b,m),m.classList.remove(I),m.classList.add(H)}),f.addEventListener("mouseleave",b=>{b.stopPropagation(),T("mouseleave",b,m),m.classList.remove(H),m.classList.add(I)})}}}e==="mouseleave"&&(t.classList.remove(H),t.classList.add(I))}function Se(){return n.createVNode("svg",{width:"16px",height:"16px",viewBox:"0 0 16 16",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},[n.createVNode("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},[n.createVNode("path",{d:`M3.64644661,5.64644661 C3.82001296,5.47288026 4.08943736,5.45359511 4.2843055,5.58859116 L4.35355339,5.64644661 
          L8,9.293 L11.6464466,5.64644661 C11.820013,5.47288026 12.0894374,5.45359511 12.2843055,5.58859116 L12.3535534,5.64644661 
          C12.5271197,5.82001296 12.5464049,6.08943736 12.4114088,6.2843055 L12.3535534,6.35355339 L8.35355339,10.3535534 
          C8.17998704,10.5271197 7.91056264,10.5464049 7.7156945,10.4114088 L7.64644661,10.3535534 L3.64644661,6.35355339 
          C3.45118446,6.15829124 3.45118446,5.84170876 3.64644661,5.64644661 Z`},null)])])}const K=C("menu"),P=C("submenu").b();var U=n.defineComponent({name:"DSubMenu",props:Ne,setup(e,l){const t=n.ref(!0),{vnode:{key:s}}=n.getCurrentInstance();let a=String(s);const o=n.inject("openKeys"),d=n.ref(o.value.includes(a)),f=n.inject("defaultIndent"),m=n.inject("isCollapsed"),b=n.inject("mode"),V=n.ref(null),v=n.inject("rootMenuEmit"),$=b.value==="horizontal";a==="null"&&(console.warn("[devui][menu]: Key can not be null"),a=`randomKey-${ae(16)}`);const M=c=>{c.stopPropagation();const y=le(c.target);if(!(y.classList.contains(P)&&$)&&($&&(ee(y,c,!0),se(c)),!e.disabled&&b.value!=="horizontal")){const r=le(c.target),i=o.value.indexOf(a);i>=0&&r.tagName==="UL"?o.value.splice(i,1):r.tagName==="UL"&&o.value.push(a),d.value=o.value.indexOf(a)>=0,v("submenu-change",{type:"submenu-change",state:d.value,key:a,el:y})}},k=n.ref(null);let A;const w=n.ref(null),L=n.ref(null);let N="";const g=n.ref("");return n.watchEffect(()=>{A=k.value,ue({el:w.value})},{flush:"post"}),n.watch(()=>o,c=>{c.value.includes(a)?d.value=!0:d.value=!1},{deep:!0}),n.onMounted(()=>{var r;const c=L.value,y=w.value;fe(),g.value=`layer_${(r=Array.from(y.classList).at(-1))==null?void 0:r.replace("layer_","")}`,$&&!e.disabled&&(w.value.addEventListener("mouseenter",i=>{i.stopPropagation(),T("mouseenter",i,A)}),w.value.addEventListener("mouseleave",i=>{i.stopPropagation(),T("mouseleave",i,A)})),n.watch(m,i=>{const p=Number(ge(y));Number.isNaN(p)||p>2&&(t.value=!m.value),i?(c.style.padding!=="0"&&(N=c.style.padding),setTimeout(()=>{c.style.padding="0",c.style.width="",c.style.textAlign="center"},300),c.style.display="block"):(c.style.padding=`${N}`,c.style.textAlign="",c.style.display="flex")})}),()=>{var c,y,r,i;return n.withDirectives(n.createVNode("ul",{onClick:M,class:[P,g.value,e.disabled&&`${P}-disabled`],ref:w},[n.createVNode("div",{class:[`${P}-title`],style:`padding: 0 ${f}px`,ref:L},[n.createVNode("span",{class:`${K.b()}-icon`},[(y=(c=l.slots)==null?void 0:c.icon)==null?void 0:y.call(c)]),n.withDirectives(n.createVNode("span",{class:`${P}-title-content`},[e.title]),[[n.vShow,!m.value]]),n.withDirectives(n.createVNode(Se,{class:[K.e("arrow-icon"),{"is-opened":d.value}]},null),[[n.vShow,!m.value&&s!=="overflowContainer"&&g.value!==`layer_${P}`]]),n.withDirectives(n.createVNode("i",{class:{"icon icon-chevron-up":!1,"icon icon-chevron-right":g.value===`layer_${P}`,"is-opened":d.value}},null),[[n.vShow,!m.value&&s!=="overflowContainer"]])]),$?n.withDirectives(n.createVNode("div",{class:`${K.b()}-item-horizontal-wrapper ${K.b()}-item-horizontal-wrapper-hidden`,ref:k},[(i=(r=l.slots).default)==null?void 0:i.call(r)]),[[n.vShow,!e.disabled]]):n.createVNode(Le,null,{default:()=>{var p,u;return[n.withDirectives(n.createVNode("div",{class:[`${P}-menu-item-vertical-wrapper`],ref:V},[(u=(p=l.slots).default)==null?void 0:u.call(p)]),[[n.vShow,d.value]])]}})]),[[n.vShow,t.value]])}}});const Ce={width:{type:String,default:""},collapsed:{type:Boolean,default:!1},collapsedIndent:{type:Number,default:24},indentSize:{type:Number,default:24},multiple:{type:Boolean,default:!1},openKeys:{type:Array,default:[]},defaultSelectKeys:{type:Array,default:[]},mode:{type:String,default:"vertical"},router:{type:Boolean,default:!1},disableOverflowStyle:{type:Boolean,default:!1}};var ze="";const E={};class Ee{constructor(l){this.rootMenuName=l}on(l,t){var s;(s=E==null?void 0:E[this.rootMenuName])!=null&&s[l]||Reflect.set(E[this.rootMenuName],l,[]),E[this.rootMenuName][l].push(t)}emit(l,...t){E[this.rootMenuName][l].forEach(s=>s(...t))}off(l,t){const s=E[this.rootMenuName][l].indexOf(t);s>=0&&E[this.rootMenuName][l].splice(s,1)}}function Me(e){return E[e]||Reflect.set(E,e,{}),new Ee(e)}var G=n.defineComponent({name:"DMenu",props:Ce,emits:["select","deselect","submenu-change"],setup(e,l){const t=C("menu"),{openKeys:s,mode:a,collapsed:o,defaultSelectKeys:d,router:f}=n.toRefs(e),m=ae(16),b=Me(m);n.provide("menuStore",b),n.provide("isCollapsed",o),n.provide("defaultIndent",e.indentSize),n.provide("multiple",e.multiple),n.provide("openKeys",s),n.provide("defaultSelectKey",d),n.provide("mode",a),n.provide("collapsedIndent",e.collapsedIndent),n.provide("rootMenuEmit",l.emit),n.provide("useRouter",f),de(e.indentSize);const V=n.ref(null),v=n.ref(0),$=n.ref(null),M=`${t.b()}-item-select`,k=n.computed(()=>({[`${t.b()}`]:!0,[`${t.b()}-vertical`]:a.value==="vertical",[`${t.b()}-horizontal`]:a.value==="horizontal",[`${t.b()}-collapsed`]:o.value})),A=n.reactive({[M]:!1,[`${t.b()}-overflow-container`]:!0}),w=L=>{const N=Array.from(L.children);for(const g of N)if(g.classList.contains(M)){A[M]=!0;break}else A[M]=!1};return n.onMounted(()=>{var L;if(e.mode==="horizontal"){let N=!1;const g=(L=$.value)==null?void 0:L.$el,c=V.value,y=c.children,r=g.children[1],i=new IntersectionObserver(p=>{p.forEach(u=>{if(!u.isIntersecting&&!e.disableOverflowStyle){const h=u.target.cloneNode(!0);u.target.classList.contains(`${t.b()}-overflow-container`)?N&&u.target.previousElementSibling&&r.children.length?c.appendChild(u.target.previousElementSibling):N=!0:(v.value+=1,u.target.style.visibility="hidden",g.nextSibling?c.insertBefore(u.target,g.nextSibling):c.appendChild(u.target),r.appendChild(h),w(r))}else if(!u.target.classList.contains(`${t.b()}-overflow-container`)&&u.target.style.visibility==="hidden"){i.unobserve(u.target),c.insertBefore(u.target,g),u.target.style.visibility="";const h=g.previousElementSibling;if(h&&u.boundingClientRect.width%u.target.getBoundingClientRect().width===0&&i.observe(h),h!=null&&h.classList.contains("devui-submenu")){const ie=h,re=h.children[1];ie.addEventListener("mouseenter",j=>{j.stopPropagation(),T("mouseenter",j,re)}),ie.addEventListener("mouseleave",j=>{j.stopPropagation(),T("mouseleave",j,re)})}v.value-=1,i.observe(u.target),r.lastChild&&r.removeChild(r.lastChild),w(r)}})},{root:c,threshold:1,rootMargin:"8px"});for(let p=0;p<y.length;p++)i.observe(y[p])}}),()=>{var L,N;return n.createVNode("ul",{ref:V,class:k.value,style:[e.collapsed?`width:${e.collapsedIndent*2}px`:`width: ${e.width}`]},[(N=(L=l.slots).default)==null?void 0:N.call(L),n.withDirectives(n.createVNode(U,{ref:$,key:"overflowContainer",title:"...",class:A},null),[[n.vShow,v.value>0&&a.value==="horizontal"&&!e.disableOverflowStyle]])])}}}),Ve={title:"Menu \u83DC\u5355",category:"\u5BFC\u822A",status:"100%",install(e){e.component(G.name,G),e.component(Z.name,Z),e.component(U.name,U)}};S.Menu=G,S.MenuItem=Z,S.SubMenu=U,S.default=Ve,Object.defineProperties(S,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
